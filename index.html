<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Cardápio Sorocabanos</title>
<style>
/* ======== ESTILOS GERAIS ======== */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-image: url("img/bg-sites.png");
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    padding: 20px;
}
.cardapio-container {
    position: relative;
    width: 100%;
    max-width: 450px;
    background: rgba(255, 255, 255, 0.95);
    border-radius: 25px;
    overflow: hidden;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
}
.background-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0.12;
    z-index: 1;
}
.content {
    position: relative;
    z-index: 2;
    padding: 30px 25px;
}
.header {
    text-align: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 3px solid #D35400;
    background-image: url("img/logo.png");
    background-position: center;
    background-size: cover;
    background-repeat: no-repeat;
    margin: -30px -25px 30px -25px;
    padding: 30px 25px;
    color: white;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    min-height: 300px;
}
.menu-items { display: flex; flex-direction: column; gap: 20px; }
.menu-item {
    background: white;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border-left: 5px solid #D35400;
}
.menu-item:hover { transform: translateY(-5px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15); }
.item-image img { width: 100%; height: 160px; object-fit: contain; transition: transform 0.3s; }
.menu-item:hover .item-image img { transform: scale(1.05); }
.item-content { padding: 18px; }
.item-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }
.item-name { font-size: 1.3em; font-weight: 700; color: #2C3E50; }
.item-price {
    background: #D35400; color: white; padding: 6px 12px; border-radius: 20px;
    font-weight: bold; font-size: 1.1em; min-width: 80px; text-align: center;
}
.item-description { color: #666; font-size: 0.92em; line-height: 1.4; margin-bottom: 8px; }
.badge { display: inline-block; padding: 3px 8px; border-radius: 10px; font-size: 0.7em; font-weight: bold; margin-top: 5px; }
.badge-veg { background: #27AE60; color: white; }
.badge-spicy { background: #E74C3C; color: white; }
.badge-cheese { background: #F39C12; color: white; }
.badge-mixed { background: #9B59B6; color: white; }
.footer {
    text-align: center; margin-top: 30px; padding: 20px;
    background: linear-gradient(135deg, rgba(243,156,18,0.9), rgba(211,84,0,0.9));
    margin: 30px -25px -30px -25px; color: white;
}
.footer-text { font-weight: 600; margin-bottom: 5px; font-size: 1.1em; }

/* ======== CARRINHO ======== */
.cart-icon {
    position: fixed; top: 20px; right: 20px;
    background: #D35400; color: white; width: 50px; height: 50px;
    border-radius: 50%; display: flex; align-items: center; justify-content: center;
    cursor: pointer; box-shadow: 0 3px 10px rgba(0,0,0,0.2);
}
.cart-count {
    position: absolute; top: -5px; right: -5px;
    background: #E74C3C; color: white; width: 20px; height: 20px;
    border-radius: 50%; font-size: 0.8em; display: flex; align-items: center; justify-content: center;
}
.cart-container {
    position: fixed; top: 20px; right: 20px;
    background: white; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    padding: 15px; width: 300px; max-height: 80vh; overflow-y: auto; z-index: 1000; display: none;
}
.cart-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #D35400; padding-bottom: 10px; margin-bottom: 15px; }
.cart-title { font-size: 1.3em; font-weight: bold; color: #2C3E50; }
.close-cart { background: none; border: none; font-size: 1.5em; cursor: pointer; color: #D35400; }
.cart-total { font-weight: bold; text-align: right; margin-bottom: 15px; font-size: 1.1em; color: #2C3E50; }
.checkout-btn {
    background: #27AE60; color: white; border: none; padding: 12px;
    border-radius: 10px; font-weight: bold; width: 100%; cursor: pointer;
}
.checkout-btn:hover { background: #2ECC71; }
.modal {
    display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.5); z-index: 2000; align-items: center; justify-content: center;
}
.modal-content {
    background: white; padding: 25px; border-radius: 15px; width: 90%; max-width: 400px;
}
.form-group { margin-bottom: 15px; }
.form-group label { display: block; font-weight: bold; margin-bottom: 5px; }
.form-group input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
.modal-btn { flex: 1; padding: 10px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; }
.cancel-btn { background: #95a5a6; color: white; }
.submit-btn { background: #27AE60; color: white; }
.loading { display: none; text-align: center; padding: 10px; color: #D35400; font-weight: bold; }
.whatsapp-option {
    background: #25D366; color: white; border: none; padding: 12px;
    border-radius: 10px; font-weight: bold; width: 100%; cursor: pointer; margin-top: 10px;
}
.whatsapp-option:hover { background: #128C7E; }
.debug-info {
    background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 5px;
    padding: 10px; margin-top: 10px; font-size: 0.8em; display: none;
}
</style>
</head>
<body>
<div class="cardapio-container">
<div class="background-image">
<img src="img/bg-sites.png" alt="Background Sorocabanos" class="background-image"/>
</div>
<div class="content">
<div class="header"></div>

<!-- ======== ITENS DO CARDÁPIO ======== -->
<div class="menu-items">
<div class="menu-item">
<div class="item-image"><img src="img/crn.png" alt="El Toro Bravo"/></div>
<div class="item-content">
<div class="item-header"><h3 class="item-name">EL TORO BRAVO</h3><span class="item-price">R$ 14,00</span></div>
<p class="item-description">Suculentos cubos de carne bovina marinados em especiarias mexicanas.</p>
<span class="badge badge-spicy">PICANTE</span>
<div class="cart-controls">
<div class="quantity-controls">
<button class="quantity-btn minus" data-item="EL TORO BRAVO">-</button>
<span class="quantity-display" data-item="EL TORO BRAVO">0</span>
<button class="quantity-btn plus" data-item="EL TORO BRAVO">+</button>
</div>
<button class="add-to-cart-btn" data-item="EL TORO BRAVO" data-price="14.00">Adicionar</button>
</div>
</div>
</div>
<!-- ... (demais itens iguais ao seu arquivo anterior) -->
</div>

<div class="footer">
<p class="footer-text">🌮 Cada espeto é uma celebração de sabores! 🌮</p>
<p class="contact">@sorocabanos_espetaria • (15) 98831-1590</p>
</div>
</div>
</div>

<!-- ======== CARRINHO ======== -->
<div class="cart-icon">🛒<span class="cart-count">0</span></div>
<div class="cart-container">
<div class="cart-header"><h3 class="cart-title">Seu Pedido</h3><button class="close-cart">×</button></div>
<div class="cart-items"></div>
<div class="cart-total">Total: R$ <span class="total-value">0,00</span></div>
<button class="checkout-btn">Finalizar Pedido</button>
</div>

<!-- ======== MODAL CLIENTE ======== -->
<div class="modal" id="customerModal">
<div class="modal-content">
<h3 class="modal-title">Informações para Entrega</h3>
<div class="form-group"><label>Nome</label><input id="customerName" type="text" placeholder="Seu nome"/></div>
<div class="form-group"><label>Telefone</label><input id="customerPhone" type="tel" placeholder="(15) 98831-1590"/></div>
<div class="form-group"><label>Endereço</label><input id="customerAddress" type="text" placeholder="Endereço completo"/></div>
<div class="loading" id="loadingIndicator">Enviando pedido...</div>
<div class="debug-info" id="debugInfo"></div>
<div class="modal-buttons">
<button class="modal-btn cancel-btn" id="cancelOrder">Cancelar</button>
<button class="modal-btn submit-btn" id="submitOrder">Enviar para Notion</button>
</div>
<button class="whatsapp-option" id="whatsappOption">📱 Enviar via WhatsApp</button>
</div>
</div>

<script>
/* ======== CONFIGURAÇÃO ======== */
let cart = {};
let cartTotal = 0;
const cartIcon = document.querySelector('.cart-icon');
const cartContainer = document.querySelector('.cart-container');
const closeCartBtn = document.querySelector('.close-cart');
const cartItemsContainer = document.querySelector('.cart-items');
const totalValueElement = document.querySelector('.total-value');
const cartCountElement = document.querySelector('.cart-count');
const checkoutBtn = document.querySelector('.checkout-btn');
const customerModal = document.getElementById('customerModal');
const cancelOrderBtn = document.getElementById('cancelOrder');
const submitOrderBtn = document.getElementById('submitOrder');
const whatsappOption = document.getElementById('whatsappOption');
const loadingIndicator = document.getElementById('loadingIndicator');
const debugInfo = document.getElementById('debugInfo');

const NOTION_API_KEY = 'secret_ntn_499935262761FCXqjijRcDhFZNQDyQwzOkoVALCuWVSeXe';
const DATABASE_ID = '29bba3d8ac0480aba4c0ccfc43b250ba';

function showDebugInfo(msg, type='info'){
    debugInfo.innerHTML = `<strong>${type.toUpperCase()}:</strong> ${msg}`;
    debugInfo.style.display='block';
    debugInfo.style.background = type==='error'?'#ffe6e6':type==='success'?'#e6ffe6':'#f0f8ff';
}

/* ======== CARRINHO ======== */
function updateCartDisplay(){
    const totalItems = Object.values(cart).reduce((s,i)=>s+i.quantity,0);
    cartCountElement.textContent = totalItems;
    cartItemsContainer.innerHTML='';
    cartTotal=0;
    Object.keys(cart).forEach(name=>{
        const i=cart[name]; const total=i.price*i.quantity; cartTotal+=total;
        const div=document.createElement('div'); div.className='cart-item';
        div.innerHTML=`<div>${name} (${i.quantity}x)</div><div>R$ ${total.toFixed(2)}</div>`;
        cartItemsContainer.appendChild(div);
    });
    totalValueElement.textContent=cartTotal.toFixed(2).replace('.',',');
}

/* ======== FUNÇÕES NOTION ======== */
async function sendOrderToNotion(name, phone, address){
    loadingIndicator.style.display='block'; submitOrderBtn.disabled=true;
    try{
        if(!NOTION_API_KEY.startsWith('secret_')) throw new Error('Chave Notion inválida');
        if(!DATABASE_ID||DATABASE_ID.length<10) throw new Error('Database ID inválido');

        const orderItems=Object.keys(cart).map(k=>{
            const i=cart[k];return `${k} (${i.quantity}x) - R$ ${(i.price*i.quantity).toFixed(2)}`;
        }).join('\\n');

        const data={parent:{database_id:DATABASE_ID},properties:{
            Nome:{title:[{text:{content:name}}]},
            Telefone:{rich_text:[{text:{content:phone}}]},
            Endereço:{rich_text:[{text:{content:address}}]},
            Itens:{rich_text:[{text:{content:orderItems}}]},
            Total:{number:parseFloat(cartTotal.toFixed(2))},
            Status:{select:{name:'Novo Pedido'}}
        }};

        const res=await fetch('https://api.notion.com/v1/pages',{
            method:'POST',
            headers:{
                'Authorization':`Bearer ${NOTION_API_KEY}`,
                'Content-Type':'application/json',
                'Notion-Version':'2022-06-28'
            },
            body:JSON.stringify(data)
        });
        if(res.ok){ showDebugInfo('Pedido enviado ao Notion!','success'); alert('🎉 Pedido enviado com sucesso!'); cart={}; updateCartDisplay(); customerModal.style.display='none'; }
        else{ const t=await res.text(); throw new Error(`Erro ${res.status}: ${t}`); }
    }catch(e){ showDebugInfo(e.message,'error'); alert('Erro ao enviar para Notion: '+e.message);}
    finally{ loadingIndicator.style.display='none'; submitOrderBtn.disabled=false;}
}

/* ======== WHATSAPP ======== */
function sendOrderToWhatsApp(name, phone, address){
    const items=Object.keys(cart).map(k=>{
        const i=cart[k]; return `${k} (${i.quantity}x) - R$ ${(i.price*i.quantity).toFixed(2)}`;
    }).join('%0A');
    const total=cartTotal.toFixed(2).replace('.',',');
    const msg=`*Novo Pedido*%0A%0A👤 ${name}%0A📞 ${phone}%0A🏠 ${address}%0A%0A${items}%0A%0ATotal: R$ ${total}`;
    window.open(`https://wa.me/5515988311590?text=${msg}`,'_blank');
}

/* ======== EVENTOS ======== */
cartIcon.onclick=()=>cartContainer.style.display='block';
closeCartBtn.onclick=()=>cartContainer.style.display='none';
checkoutBtn.onclick=()=>{if(Object.keys(cart).length===0)return alert('Carrinho vazio!'); customerModal.style.display='flex';};
cancelOrderBtn.onclick=()=>customerModal.style.display='none';
submitOrderBtn.onclick=()=>{const n=document.getElementById('customerName').value,p=document.getElementById('customerPhone').value,a=document.getElementById('customerAddress').value;if(!n||!p||!a)return alert('Preencha tudo!'); sendOrderToNotion(n,p,a);};
whatsappOption.onclick=()=>{const n=document.getElementById('customerName').value,p=document.getElementById('customerPhone').value,a=document.getElementById('customerAddress').value;if(!n||!p||!a)return alert('Preencha tudo!'); sendOrderToWhatsApp(n,p,a);};

showDebugInfo('Sistema pronto!','info');
</script>
</body>
</html>
